	.include "asm/macros.inc"
	.include "global.inc"

	.text

	arm_func_start Main
Main: ; 0x02000800
	mov r12, #0x4000000
	str r12, [r12, #0x208]
_02000808:
	ldrh r0, [r12, #0x6]
	cmp r0, #0x0
	bne _02000808
	bl sub_02000A78
	mov r0, #0x13
	msr cpsr_c, r0
	ldr r0, _02000918 ; =0x027E0000
	add r0, r0, #0x3fc0
	mov sp, r0
	mov r0, #0x12
	msr cpsr_c, r0
	ldr r0, _02000918 ; =0x027E0000
	add r0, r0, #0x3fc0
	sub r0, r0, #0x40
	sub sp, r0, #0x4
	tst sp, #0x4
	subeq sp, sp, #0x4
	ldr r1, _0200091C ; =0x00000400
	sub r1, r0, r1
	mov r0, #0x1f
	msr cpsr_fsxc, r0
	sub sp, r1, #0x4
	mov r0, #0x0
	ldr r1, _02000918 ; =0x027E0000
	mov r2, #0x4000
	bl _0200093C
_02000870:
	.byte 0x00, 0x00, 0xA0, 0xE3, 0xA4, 0x10, 0x9F, 0xE5, 0x01, 0x2B, 0xA0, 0xE3, 0x2E, 0x00, 0x00, 0xEB
	.byte 0x02, 0x0C, 0xA0, 0xE3, 0x98, 0x10, 0x9F, 0xE5, 0x01, 0x2B, 0xA0, 0xE3, 0x2A, 0x00, 0x00, 0xEB
	.byte 0x90, 0x10, 0x9F, 0xE5, 0x14, 0x00, 0x91, 0xE5, 0x2C, 0x00, 0x00, 0xEB, 0x56, 0x00, 0x00, 0xEB
	.byte 0x80, 0x00, 0x9F, 0xE5, 0x0C, 0x10, 0x90, 0xE5, 0x10, 0x20, 0x90, 0xE5, 0x01, 0x30, 0xA0, 0xE1
	.byte 0x00, 0x00, 0xA0, 0xE3, 0x02, 0x00, 0x51, 0xE1, 0x04, 0x00, 0x81, 0x34, 0xFC, 0xFF, 0xFF, 0x3A
	.byte 0x1F, 0x10, 0xC3, 0xE3, 0x9A, 0x0F, 0x07, 0xEE, 0x35, 0x1F, 0x07, 0xEE, 0x3E, 0x1F, 0x07, 0xEE
	.byte 0x20, 0x10, 0x81, 0xE2, 0x02, 0x00, 0x51, 0xE1, 0xF9, 0xFF, 0xFF, 0xBA, 0x48, 0x10, 0x9F, 0xE5
	.byte 0x00, 0x00, 0x81, 0xE5, 0x2C, 0x10, 0x9F, 0xE5, 0xFF, 0x1D, 0x81, 0xE2, 0x3C, 0x10, 0x81, 0xE2
	.byte 0x38, 0x00, 0x9F, 0xE5, 0x00, 0x00, 0x81, 0xE5, 0x33, 0xAF, 0x03, 0xEB, 0x98, 0x00, 0x00, 0xEB
	.byte 0x63, 0xAF, 0x03, 0xEB, 0x28, 0x10, 0x9F, 0xE5, 0x28, 0xE0, 0x9F, 0xE5, 0x04, 0x00, 0x1D, 0xE3
	.byte 0x04, 0xD0, 0x4D, 0x12, 0x11, 0xFF, 0x2F, 0xE1
_02000918: .word 0x027E0000
_0200091C: .word 0x00000400
_02000920:
	.byte 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x07, 0x68, 0x0B, 0x00, 0x02, 0x9C, 0xFF, 0x7F, 0x02
	.byte 0x00, 0x80, 0xFF, 0x01, 0x55, 0x0C, 0x00, 0x02, 0x00, 0x00, 0xFF, 0xFF
_0200093C:
	add r12, r1, r2
_02000940:
	cmp r1, r12
	stmltia r1!, {r0}
	blt _02000940
	bx lr

	arm_func_start sub_02000950
sub_02000950: ; 0x02000950
	cmp r0, #0x0
	beq _020009F8
	stmdb sp!, {r4-r7}
	ldmdb r0, {r1-r2}
	add r2, r0, r2
	sub r3, r0, r1, lsr #0x18
	bic r1, r1, #0xff000000
	sub r1, r0, r1
	mov r4, r2
_02000974:
	cmp r3, r1
	ble _020009D4
	ldrb r5, [r3, #-0x1]!
	mov r6, #0x8
_02000984:
	subs r6, r6, #0x1
	blt _02000974
	tst r5, #0x80
	bne _020009A0
	ldrb r0, [r3, #-0x1]!
	strb r0, [r2, #-0x1]!
	b _020009C8
_020009A0:
	ldrb r12, [r3, #-0x1]!
	ldrb r7, [r3, #-0x1]!
	orr r7, r7, r12, lsl #0x8
	bic r7, r7, #0xf000
	add r7, r7, #0x2
	add r12, r12, #0x20
_020009B8:
	ldrb r0, [r2, r7]
	strb r0, [r2, #-0x1]!
	subs r12, r12, #0x10
	bge _020009B8
_020009C8:
	cmp r3, r1
	mov r5, r5, lsl #0x1
	bgt _02000984
_020009D4:
	mov r0, #0x0
	bic r3, r1, #0x1f
_020009DC:
	mcr p15, 0x0, r0, c7, c10, 0x4
	mcr p15, 0x0, r3, c7, c5, 0x1
	mcr p15, 0x0, r3, c7, c14, 0x1
	add r3, r3, #0x20
	cmp r3, r4
	blt _020009DC
	ldmia sp!, {r4-r7}
_020009F8:
	bx lr
_020009FC:
	.byte 0x6C, 0x00, 0x9F, 0xE5
	.byte 0x00, 0x10, 0x90, 0xE5, 0x04, 0x20, 0x90, 0xE5, 0x08, 0x30, 0x90, 0xE5, 0x02, 0x00, 0x51, 0xE1
	.byte 0x15, 0x00, 0x00, 0x0A, 0x04, 0x50, 0x91, 0xE4, 0x04, 0x70, 0x91, 0xE4, 0x07, 0x60, 0x85, 0xE0
	.byte 0x05, 0x40, 0xA0, 0xE1, 0x06, 0x00, 0x54, 0xE1, 0x04, 0x70, 0x93, 0x44, 0x04, 0x70, 0x84, 0x44
	.byte 0xFB, 0xFF, 0xFF, 0x4A, 0x04, 0x70, 0x91, 0xE4, 0x07, 0x60, 0x84, 0xE0, 0x00, 0x70, 0xA0, 0xE3
	.byte 0x06, 0x00, 0x54, 0xE1, 0x04, 0x70, 0x84, 0x34, 0xFC, 0xFF, 0xFF, 0x3A, 0x1F, 0x40, 0xC5, 0xE3
	.byte 0x9A, 0x7F, 0x07, 0xEE, 0x35, 0x4F, 0x07, 0xEE, 0x3E, 0x4F, 0x07, 0xEE, 0x20, 0x40, 0x84, 0xE2
	.byte 0x06, 0x00, 0x54, 0xE1, 0xF9, 0xFF, 0xFF, 0xBA, 0xE7, 0xFF, 0xFF, 0xEA, 0x00, 0x00, 0x00, 0xEA
	.byte 0x68, 0x0B, 0x00, 0x02, 0x1E, 0xFF, 0x2F, 0xE1

	arm_func_start sub_02000A78
sub_02000A78: ; 0x02000A78
	mrc p15, 0x0, r0, c1, c0, 0x0
	ldr r1, _02000B30 ; =0x000F9005
	bic r0, r0, r1
	mcr p15, 0x0, r0, c1, c0, 0x0
	mov r0, #0x0
	mcr p15, 0x0, r0, c7, c5, 0x0
	mcr p15, 0x0, r0, c7, c6, 0x0
	mcr p15, 0x0, r0, c7, c10, 0x4
	ldr r0, _02000B34 ; =0x04000033
	mcr p15, 0x0, r0, c6, c0, 0x0
	ldr r0, _02000B38 ; =0x0200002D
	mcr p15, 0x0, r0, c6, c1, 0x0
	ldr r0, _02000B3C ; =0x027E0021
	mcr p15, 0x0, r0, c6, c2, 0x0
	ldr r0, _02000B40 ; =0x08000035
	mcr p15, 0x0, r0, c6, c3, 0x0
	ldr r0, _02000B44 ; =0x027E0000
	orr r0, r0, #0x1a
	orr r0, r0, #0x1
	mcr p15, 0x0, r0, c6, c4, 0x0
	ldr r0, _02000B48 ; =0x0100002F
	mcr p15, 0x0, r0, c6, c5, 0x0
	ldr r0, _02000B4C ; =0xFFFF001D
	mcr p15, 0x0, r0, c6, c6, 0x0
	ldr r0, _02000B50 ; =0x027FF017
	mcr p15, 0x0, r0, c6, c7, 0x0
	mov r0, #0x20
	mcr p15, 0x0, r0, c9, c1, 0x1
	ldr r0, _02000B44 ; =0x027E0000
	orr r0, r0, #0xa
	mcr p15, 0x0, r0, c9, c1, 0x0
	mov r0, #0x42
	mcr p15, 0x0, r0, c2, c0, 0x1
	mov r0, #0x42
	mcr p15, 0x0, r0, c2, c0, 0x0
	mov r0, #0x2
	mcr p15, 0x0, r0, c3, c0, 0x0
	ldr r0, _02000B54 ; =0x05100011
	mcr p15, 0x0, r0, c5, c0, 0x3
	ldr r0, _02000B58 ; =0x15111011
	mcr p15, 0x0, r0, c5, c0, 0x2
	mrc p15, 0x0, r0, c1, c0, 0x0
	ldr r1, _02000B5C ; =0x0005707D
	orr r0, r0, r1
	mcr p15, 0x0, r0, c1, c0, 0x0
	bx lr
	.align 2, 0
_02000B30: .word 0x000F9005
_02000B34: .word 0x04000033
_02000B38: .word 0x0200002D
_02000B3C: .word 0x027E0021
_02000B40: .word 0x08000035
_02000B44: .word 0x027E0000
_02000B48: .word 0x0100002F
_02000B4C: .word 0xFFFF001D
_02000B50: .word 0x027FF017
_02000B54: .word 0x05100011
_02000B58: .word 0x15111011
_02000B5C: .word 0x0005707D

	arm_func_start sub_02000B60_dummy
sub_02000B60_dummy:
	bx lr

	arm_func_start sub_02000B64_dummy
sub_02000B64_dummy:
	bx lr

_02000B68:
	.word 0x02107700
	.word 0x02107724
	.word 0x02106FA0
	.word 0x02106FA0
	.word 0x021D74E0
	.word 0x00000000

	.byte 0x31, 0x75, 0x02, 0x03, 0x21, 0x06, 0xC0, 0xDE, 0xDE, 0xC0, 0x06, 0x21
	
	# strings
	.balign 4
	.asciz "[SDK+NINTENDO:DWC1.2.30006.061019.2254_DWC_1_2_PLUS6]"
	.balign 4
	.asciz "[SDK+NINTENDO:WiFi1.2.30000.0609050341]"
	.balign 4
	.asciz "[SDK+UBIQUITOUS:CPS]"
	.balign 4
	.asciz "[SDK+UBIQUITOUS:SSL]"
	.balign 4
	.asciz "[SDK+Abiosso:libVCT 1.0.1_ec]"
	.balign 4
	.asciz "[SDK+NINTENDO:BACKUP]"
